**任务状态值：**

API 返回以下状态值之一：

| 状态 | 描述 |
|--------|-------------|
| `pending` | 任务已排队，等待开始 |
| `in_progress` | 任务正在执行 |
| `completed` | 任务成功完成 |
| `failed` | 任务遇到错误 |
| `cancelled` | 任务被用户取消 |

<CodeGroup>
```bash curl
# 轮询任务完成状态
curl -X GET "$BASE_URL/api/job/{prompt_id}/status" \
  -H "X-API-Key: $COMFY_CLOUD_API_KEY"

# 响应示例：
# {"status": "pending"}      - 任务已排队
# {"status": "in_progress"}  - 任务正在运行
# {"status": "completed"}    - 任务成功完成
# {"status": "failed"}       - 任务遇到错误
# {"status": "cancelled"}    - 任务被取消
```

```typescript TypeScript
interface JobStatus {
  status: string;
}

async function getJobStatus(promptId: string): Promise<JobStatus> {
  const response = await fetch(`${BASE_URL}/api/job/${promptId}/status`, {
    headers: getHeaders(),
  });
  if (!response.ok) throw new Error(`HTTP ${response.status}`);
  return response.json();
}

async function pollForCompletion(
  promptId: string,
  timeout: number = 300,
  pollInterval: number = 2000
): Promise<void> {
  const startTime = Date.now();

  while (Date.now() - startTime < timeout * 1000) {
    const { status } = await getJobStatus(promptId);

    if (status === "completed") {
      return;
    } else if (["failed", "cancelled"].includes(status)) {
      throw new Error(`任务失败，状态：${status}`);
    }

    await new Promise((resolve) => setTimeout(resolve, pollInterval));
  }

  throw new Error(`任务 ${promptId} 在 ${timeout}s 内未完成`);
}

await pollForCompletion(promptId);
console.log("任务已完成！");
```

```python Python
def get_job_status(prompt_id: str) -> str:
    """获取任务的当前状态。"""
    response = requests.get(
        f"{BASE_URL}/api/job/{prompt_id}/status",
        headers=get_headers()
    )
    response.raise_for_status()
    return response.json()["status"]

def poll_for_completion(prompt_id: str, timeout: int = 300, poll_interval: float = 2.0) -> None:
    """轮询直到任务完成或超时。"""
    start_time = time.time()

    while time.time() - start_time < timeout:
        status = get_job_status(prompt_id)

        if status == "completed":
            return
        elif status in ("failed", "cancelled"):
            raise RuntimeError(f"任务失败，状态：{status}")

        time.sleep(poll_interval)

    raise TimeoutError(f"任务 {prompt_id} 在 {timeout}s 内未完成")

poll_for_completion(prompt_id)
print("任务已完成！")
```
</CodeGroup>
