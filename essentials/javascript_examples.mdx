---
title: "Annotated Examples"
---

A growing collection of bits of example code...

## Comfy UI preference settings

### Add and read a setting

```Javascript
import { app } from "../../scripts/app.js";

/* In setup(), add the setting */
    app.ui.settings.addSetting({
        id: "unique.setting.name",
        name: "Switch my cool extension on?",
        type: "boolean", // "text" is another simple option
        defaultValue: false,
        /* To listen for changes, add an onChange parameter
        onChange: (newVal, oldVal) => { console.log("Setting got changed!") },
        */
    });

/* then elsewhere, read it (with a default value just in case) */
    if (app.ui.settings.getSettingValue("unique.setting.name", false)) { 
        /* do something */
    }
```

### Sliders for numbers

The type `slider` lets the user enter a value directly or via a slider:

```Javascript
    app.ui.settings.addSetting({
        id: "unique.setting.slider",
        name: "Move me around",
        type: "slider",
        attrs: { min: -1, max: 500, step: 1, },
        defaultValue: 0,
        onChange: (newVal, oldVal) => { console.log(`Setting got changed to ${newVal}`) },
    });
```

## Capture UI events

This works just like you'd expect. In `setup()`, once the page has fully loaded:

```Javascript
function queue_button_pressed() { console.log("Queue button was pressed!") }
document.getElementById("queue-button").addEventListener("click", queue_button_pressed);
```

## Do something when a workflow starts

This is one of many `api` events:

```javascript
import { api } from "../../scripts/api.js";
/* in setup() */
    function on_execution_start() { 
        /* do whatever */
    }
    api.addEventListener("execution_start", on_execution_start);
```

## Detect an interrupted workflow

A simple example of hijacking the api:

```Javascript
import { api } from "../../scripts/api.js";
/* in setup() */
    const original_api_interrupt = api.interrupt;
    api.interrupt = function () {
        /* Do something before the original method is called */
        original_api_interrupt.apply(this, arguments);
        /* Or after */
    }
```

## Catch clicks on your node

`node` has a mouseDown method you can hijack. 
This time we're careful to pass on any return value.

```javascript
async nodeCreated(node) {
    if (node?.comfyClass === "My Node Name") {
        const original_onMouseDown = node.onMouseDown;
        node.onMouseDown = function( e, pos, canvas ) {
            alert("ouch!");
            return org_onMouseDown?.apply(this, arguments);
        }        
    }
}
```
