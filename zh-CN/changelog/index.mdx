---
title: "更新日志"
description: "跟踪ComfyUI的最新功能、改进和错误修复"
icon: "clock-rotate-left"
---

<Update label="v0.3.35" description="2025年7月9日">

**音频和视频处理增强**

此版本通过改进的音频输出格式和增强的视频处理工作流程，显著扩展了ComfyUI的多媒体功能：

## 音频输出改进
- **扩展格式支持**：音频输出节点现在支持Opus和MP3格式，为音频生成工作流程提供更好的压缩选项
- **增强音频处理**：为AI生成音乐和声音设计项目提供更灵活的音频导出格式

## 视频生成进步
- **3D节点视频录制**：添加了对3D节点录制视频输出的支持，实现了无缝的3D转视频工作流程创建
- **视频时长API**：ComfyUI VIDEO类型的新`get_duration`方法改善了视频处理节点开发
- **Wan-FUN相机控制**：新的WanCameraImageToVideo节点具有相机控制模型，可进行精确相机移动的高级视频生成
- **视频输入验证**：增强的视频输入验证防止工作流程错误并提高稳定性

## 字符串操作和工作流程实用工具
- **基础字符串操作**：用于基本字符串操作任务的新节点，对提示词工程和文本处理工作流程至关重要
- **带分隔符的连接**：增强的字符串连接节点，支持可自定义分隔符，用于灵活的文本组合
- **像素空间噪声**：用于向图像添加像素级噪声的新节点，适用于训练数据增强和艺术效果

## 高级采样和引导
- **APG引导实现**：添加了具有动量修复的自适应投影梯度（APG）引导，以实现更稳定和受控的生成
- **ImagePadForOutpaint**：现在返回适当的3通道掩码，以获得更好的outpainting工作流程兼容性

## 模型支持扩展
- **ACE Step LoRA**：官方支持ACE Step LoRA模型，扩展了微调功能
- **Hunyuan Custom**：Hunyuan模型集成的初始实现（实验性）
- **RMSNorm兼容性**：修复了旧版PyTorch RMSNorm实现的问题，提供更广泛的模型兼容性

## 开发者体验改进
- **强大的客户端API**：重写了client.py，增强了错误处理和API请求日志记录，以便更好地调试
- **进度显示**：API节点现在直接在界面中显示进度和结果URL
- **任务失败处理**：改进的错误处理防止API任务失败时不必要的请求重试
- **T5TokenizerOption**：添加了缺失的类别，以便更好地组织节点

## 平台和性能更新
- **AMD GPU支持**：更新了ROCm说明和AMD用户的兼容性信息
- **Windows便携版**：移除了过时的PyTorch 2.4兼容性hack，以实现更清洁的Windows部署
- **内存管理**：针对不同硬件配置的内存使用进行了各种优化

这些改进使ComfyUI在多媒体AI工作流程中更加多功能，同时保持稳定性并为从事音频、视频和高级文本处理的艺术家扩展创作可能性。

</Update>
<Update label="v0.3.44" description="2025年7月8日">

**高级采样和模型控制增强**

此版本在采样算法和模型控制系统方面提供了重大改进，特别有利于高级AI研究人员和工作流创建者：

## 新采样功能
- **TCFG节点**：增强的分类器无关引导控制，为您的工作流提供更细致的生成控制
- **ER-SDE采样器**：从VE迁移到VP算法，配备新的采样器节点，为复杂生成任务提供更好的数值稳定性
- **跳层引导（SLG）**：用于推理期间精确层级控制的替代实现，完美适用于高级模型导向工作流

## 增强的开发工具
- **自定义节点管理**：新的`--whitelist-custom-nodes`参数与`--disable-all-custom-nodes`配对，提供精确的开发控制
- **性能优化**：双CFG节点现在在CFG为1.0时自动优化，减少计算开销
- **GitHub Actions集成**：自动化发布webhook通知让开发者及时了解新更新

## 图像处理改进
- **新变换节点**：添加了ImageRotate和ImageFlip节点，增强图像操作工作流
- **ImageColorToMask修复**：修正了掩码值返回，提供更准确的基于颜色的掩码操作
- **3D模型支持**：上传3D模型到自定义子文件夹，为复杂项目提供更好的组织

## 引导和条件增强
- **PerpNeg引导器**：更新了改进的前后CFG处理以及性能优化
- **潜在条件修复**：解决了多步骤工作流中索引 > 0 的条件问题
- **去噪步骤**：为多个采样器添加去噪步骤支持，获得更清洁的输出

## 平台稳定性
- **PyTorch兼容性**：修复了PyTorch nightly构建的连续内存问题
- **FP8回退**：当FP8操作遇到异常时自动回退到常规操作
- **音频处理**：移除了已弃用的torchaudio.save函数依赖并修复警告

## 模型集成
- **Moonvalley节点**：为Moonvalley模型工作流添加原生支持
- **调度器重新排序**：简单调度器现在默认优先，提供更好的用户体验
- **模板更新**：多个模板版本更新（0.1.31-0.1.35），改进自定义节点开发

## 安全性和安全保护
- **安全加载**：在不安全加载文件时添加警告，文档说明检查点文件默认安全加载
- **文件验证**：增强检查点加载安全措施，确保工作流安全执行

这些改进使ComfyUI在生产工作流中更加稳健，同时为使用高级采样技术和模型控制系统的AI艺术家扩展了创作可能性。

</Update>
<Update label="v0.3.43" description="2025年6月30日">

**增强模型支持与工作流可靠性**

本次发布在模型兼容性和工作流稳定性方面带来了重大改进：

- **扩展模型文档**：为 Flux Kontext 和 Omnigen 2 模型添加了全面的支持文档，让创作者更容易将这些强大的模型集成到他们的工作流中
- **VAE 编码改进**：移除了 VAE 编码过程中不必要的随机噪声注入，使工作流运行的输出更加一致和可预测
- **内存管理修复**：解决了专门影响 Kontext 模型使用的关键内存估算错误，防止内存不足错误并提高工作流稳定性

这些变更提升了高级模型工作流的可靠性，同时保持了 ComfyUI 为从事前沿生成模型工作的 AI 艺术家和研究人员提供的灵活性。

</Update>

<Update label="v0.3.41" description="2025年6月17日">

**主要模型支持新增**
- **Cosmos Predict2 支持**：全面实现文本到图像（2B 和 14B 模型）和图像到视频生成工作流，扩展视频创作功能
- **增强的 Flux 兼容性**：Chroma Text Encoder 现在能与常规 Flux 模型无缝协作，提升文本条件质量
- **LoRA 训练集成**：使用权重适配器方案的全新原生 LoRA 训练节点，支持在 ComfyUI 工作流中直接进行模型微调

**性能和硬件优化**
- **AMD GPU 增强**：在 GFX1201 和其他兼容的 AMD GPU 上启用 FP8 操作和 PyTorch 注意力机制，加速推理
- **Apple Silicon 修复**：解决了 Apple 设备上长期存在的 FP16 注意力问题，提升 Mac 用户的稳定性
- **Flux 模型稳定性**：解决了特定 Flux 模型在 FP16 精度下生成黑色图像的问题

**高级采样改进**
- **Rectified Flow (RF) 采样器**：新增支持 RF 的 SEEDS 和多步 DPM++ SDE 采样器，为前沿模型提供更多采样选项
- **ModelSamplingContinuousEDM**：新增 cosmos_rflow 选项，增强对 Cosmos 模型的采样控制
- **内存优化**：改进了支持无限分辨率的 Cosmos 模型的内存估算

**开发者和集成功能**
- **SQLite 数据库支持**：增强自定义节点和工作流存储的数据管理功能
- **PyProject.toml 集成**：从 pyproject 文件自动注册 web 文件夹和配置设置
- **前端灵活性**：支持语义化版本后缀和预发布前端版本，适用于自定义部署
- **分词器增强**：通过 tokenizer_data 配置 min_length 设置，优化文本处理

**使用体验改进**
- **Kontext 宽高比修复**：解决了仅限小组件的限制，现在在所有连接模式下都能正常工作
- **SaveLora 一致性**：统一所有保存节点的文件名格式，优化文件组织
- **Python 版本警告**：为过时的 Python 安装添加警报，防止兼容性问题
- **WebcamCapture 修复**：修正了 IS_CHANGED 签名，确保实时输入工作流的可靠性

此版本显著扩展了 ComfyUI 的模型生态系统支持，同时提供了关键的稳定性改进和跨平台硬件兼容性增强。

</Update>


<Update label="v0.3.40" description="2025年6月5日">

本次发布为 ComfyUI 创作者带来了强大的新工作流实用工具和性能优化：

## 新的工作流工具
- **ImageStitch 节点**：在工作流中无缝拼接多个图像 - 非常适合创建对比网格或复合输出
- **GetImageSize 节点**：提取图像尺寸并支持批处理，对于动态调整大小的工作流至关重要
- **Regex Replace 节点**：高级文本处理功能，适用于提示词工程和字符串处理工作流

## 增强的模型兼容性
- **改进的张量处理**：简化的列表处理使复杂的多模型工作流更加可靠
- **BFL API 优化**：完善了对 Kontext [pro] 和 [max] 模型的支持，提供更清晰的节点界面
- **性能提升**：在色度处理中使用融合乘加运算，加快生成速度

## 开发者体验改进
- **自定义节点支持**：添加 pyproject.toml 支持，改善自定义节点依赖管理
- **帮助菜单集成**：在节点库侧边栏中新增帮助系统，加快节点发现速度
- **API 文档**：增强 API 节点文档，支持工作流自动化

## 前端和 UI 增强
- **前端更新至 v1.21.7**：多项稳定性修复和性能改进
- **自定义 API 基础支持**：改进了自定义部署配置的子路径处理
- **安全加固**：修复 XSS 漏洞，确保工作流分享更安全

## 错误修复和稳定性
- **Pillow 兼容性**：更新了已弃用的 API 调用，保持与最新图像处理库的兼容性
- **ROCm 支持**：改进了 AMD GPU 用户的版本检测
- **模板更新**：增强了自定义节点开发的项目模板

这些更新强化了 ComfyUI 处理复杂 AI 工作流的基础，同时通过改进的文档和辅助工具让平台对新用户更加友好。

</Update>
