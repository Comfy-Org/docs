---
title: "更新日志"
description: "跟踪 ComfyUI 的最新功能、改进和错误修复"
icon: "clock-rotate-left"
---

<Update label="v0.3.51" description="2024年12月31日">

**主要模型支持与上下文窗口增强**

这个全面的版本引入了突破性的模型支持和采样改进，显著扩展了 ComfyUI 在高级 AI 工作流方面的能力：

**革命性模型集成**
- **Qwen 图像和编辑模型支持**：完整实现了 Qwen 视觉-语言模型，具备专用的编辑能力，支持复杂的图像理解和操作工作流
- **FluxKontextMultiReferenceLatentMethod 节点**：用于 Flux 工作流中多参考潜在处理的新高级节点，为生成一致性提供增强控制
- **WAN 2.2 相机模型**：实现了 WAN 2.2 相机功能，为视频生成工作流带来专业相机控制功能

**核心采样架构改进**
- **上下文窗口支持**：对核心采样代码进行重大增强，具备强大的上下文窗口支持，支持处理更长序列和更复杂的生成任务
- **SDPA 后端优先级**：优化了缩放点积注意力后端优先级设置，提高了不同硬件配置下的性能
- **强大的上下文步骤检测**：显著改进上下文步骤索引检测算法，提高长格式内容生成的可靠性

**音频和多媒体功能**
- **音频录制节点**：新的原生音频录制功能，将 ComfyUI 转变为综合多媒体创作平台
- **音频视频 (AV) 集成**：基本的音频-视频依赖项现已完全集成，实现无缝多媒体工作流创建

**API 和外部服务增强**
- **GPT-5 系列模型**：通过增强的 API 节点支持最新的 GPT-5 模型系列
- **Kling V2-1 和 V2-1-Master**：更新了 Kling 视频生成模型，具备改进的功能
- **Minimax Hailuo 视频节点**：新的视频生成节点，扩展创意可能性
- **Vidu 视频节点**：为多样化内容创作提供额外的视频处理能力
- **Google 模型更新**：Google 最新模型的发布版本，用于增强 AI 工作流

**性能和稳定性优化**
- **XPU iGPU 回归修复**：解决了 Intel 集成 GPU 兼容性问题，恢复了 Intel Arc 用户的性能
- **PyTorch 兼容性**：增强了与旧版 PyTorch 的向后兼容性，同时保持现代功能
- **Torch Compile 优化**：改进了 torch compile 行为，避免在旧版 PyTorch 安装中出现图形中断
- **内存管理**：优化了便携式安装大小并改善了内存效率

**开发者体验增强**
- **前端版本 1.25.9**：更新了用户界面，提高了稳定性和用户体验功能
- **模板更新**：升级到版本 0.1.62，具备增强的节点模板和文档
- **节点 Schema V3**：将 WAN 节点转换为现代 V3 schema，提高可靠性和性能
- **OpenAI API 改进**：修复了 OpenAI GPT Image 节点中多部分上传的 MIME 类型处理

**工作流优势**
- **高级图像编辑**：Qwen 编辑模型支持使用自然语言指令进行复杂的图像修改工作流
- **长格式生成**：上下文窗口增强功能支持扩展的创意项目和复杂叙述生成
- **专业视频制作**：WAN 2.2 相机控制和多种视频 API 选项提供广播级视频创作能力
- **多媒体集成**：原生音频录制和 AV 支持创建全面的多媒体制作工作流
- **硬件优化**：改进了跨 Intel、AMD 和 NVIDIA 硬件配置的兼容性
- **API 灵活性**：扩展的外部服务集成支持结合本地和云端 AI 模型的混合工作流

</Update>
<Update label="v0.3.50" description="2025年8月13日">

**模型集成与性能提升**

本次更新扩展了ComfyUI的模型支持，优化了API功能，并提升了工作流程的稳定性：

**Qwen模型生态**
- **Qwen图像模型支持**：改进了LoRA加载和模型合并功能，支持更复杂的视觉工作流程
- **Qwen模型合并节点**：新增节点，支持合并Qwen图像模型
- **SimpleTuner Lycoris LoRA支持**：扩展了对Qwen-Image模型的Lycoris LoRA兼容性

**API与性能**
- **异步API节点**：引入异步API节点，支持非阻塞工作流程执行
- **内存处理优化**：RepeatLatentBatch节点改进，能正确处理多维latent
- **WAN 2.2 Fun Control支持**：新增对WAN 2.2 fun control功能的支持

**硬件优化**
- **AMD GPU改进**：提升了AMD Radeon的FP16精度处理和性能
- **RDNA3架构修复**：解决了gfx1201 GPU使用Flux模型的问题
- **PyTorch支持更新**：升级了CUDA和ROCM PyTorch版本

**开发体验**
- **日志记录优化**：功能标志仅在详细模式下显示
- **音频处理安全**：增强了torchaudio导入安全检查
- **Kling API改进**：修复了Kling Image API节点的图像类型参数

</Update>
<Update label="v0.3.49" description="2025年8月5日">

**界面优化与模型支持**

此版本改进了用户体验，增加了前沿模型支持：

**用户界面**
- **最近项目 API**：新增跟踪最近使用项目的API
- **工作流导航优化**：改进了常用元素的组织

**模型集成**
- **Qwen视觉模型支持**：初步支持Qwen图像模型
- **图像处理优化**：增强了Qwen模型集成

**视频生成**
- **Veo3视频生成**：新增Veo3视频生成节点，支持音频
- **音视频合成**：在单个节点中结合视频和音频生成

**性能与稳定**
- **内存管理优化**：优化了条件VRAM使用
- **设备一致性**：修复了条件数据和上下文的设备问题
- **ControlNet稳定性**：解决了ControlNet兼容性问题

**开发与系统**
- **错误处理**：添加了条件设备不匹配的警告
- **模板更新**：更新了多个模板版本

</Update>
<Update label="v0.3.48" description="2025年8月2日">

**API增强与性能优化**

此版本引入了后端改进和性能优化：

**ComfyAPI框架**
- **ComfyAPI Core v0.0.2**：核心API框架更新，提升了稳定性和可扩展性
- **部分执行支持**：新增后端支持部分工作流执行

**视频处理**
- **WAN Camera内存优化**：改进了基于WAN的相机工作流内存管理
- **WanFirstLastFrameToVideo修复**：解决了视频生成的关键问题

**性能与模型**
- **VAE优化**：在VAE操作中优化了torch.silu
- **WAN VAE优化**：对WAN VAE操作进行了优化

**节点架构**
- **V3节点架构**：实现了下一代节点架构系统
- **模板更新**：更新了多个模板版本

</Update>
<Update label="v0.3.47" description="2025年7月30日">

**内存优化与大模型性能**

本次更新优化了大模型工作流的内存使用：

**WAN 2.2模型**
- **内存占用减少**：减少了WAN 2.2 VAE操作的内存使用
- **5B I2V模型支持**：优化了WAN 2.2 5B图像到视频模型

**VRAM管理**
- **Windows大显卡支持**：为Windows高端显卡增加了VRAM分配
- **内存分配改进**：改进了多大模型用户的内存管理

</Update>
<Update label="v0.3.46" description="2025年7月28日">

**硬件加速和音频处理**

此版本扩展了硬件支持并增强了音频处理：

**音频处理**
- **PyAV音频后端**：用PyAV替换torchaudio.load
- **音频集成优化**：增强了多媒体生成工作流的音频处理

**硬件支持**
- **Iluvatar CoreX支持**：添加了对Iluvatar CoreX加速器的支持
- **Intel XPU优化**：改进了XPU支持
- **AMD ROCm增强**：在Torch 2.8上为gfx1201启用了PyTorch attention
- **CUDA内存管理**：修复了CUDA malloc激活问题

**采样算法**
- **Euler CFG++增强**：分离了去噪和噪声估计过程
- **WAN模型支持**：添加了对WAN模型的全面支持

**训练功能**
- **训练节点增强**：添加了算法支持、梯度累积和可选梯度检查点
- **训练灵活性**：提供了更好的内存管理和性能优化

**节点和工作流**
- **Moonvalley V2V节点**：添加了Moonvalley Marey V2V节点
- **负面提示词更新**：改进了Moonvalley节点的负面提示词处理
- **历史API增强**：向get_history API添加了map_function参数

**API和系统**
- **前端版本跟踪**：在/system_stats API响应中添加了required_frontend_version
- **设备信息**：增强了XPU设备名称打印
- **模板更新**：更新了多个模板版本

**开发体验**
- **文档更新**：增强了README和模型集成指南
- **行结束符修复**：标准化了工作流中的行结束符
- **代码清理**：移除了已弃用的代码

</Update>
<Update label="v0.3.45" description="2025年7月21日">

**采样与训练功能改进**

本版本增强了采样算法和训练功能：

**采样和生成功能**
- **SA-Solver采样器**：新的重构SA-Solver采样算法
- **实验性CFGNorm节点**：无分类器引导标准化节点
- **嵌套双CFG支持**：为DualCFGGuider节点添加嵌套风格配置
- **SamplingPercentToSigma节点**：用于计算sigma的新实用节点

**训练功能**
- **多数据集支持**：LoRA训练节点支持多个图像-描述数据集
- **训练循环优化**：优化了训练算法
- **错误检测增强**：为LoRA操作添加了模型检测错误提示

**平台和性能**
- **异步节点支持**：完全支持异步节点函数
- **Chroma灵活性**：取消了Chroma中硬编码的patch_size参数
- **LTXV VAE解码器**：切换到改进的默认填充模式
- **Safetensors内存管理**：为mmap问题添加了解决方案

**API和集成**
- **自定义提示ID**：API允许指定提示ID
- **Kling API优化**：增加了轮询超时时间
- **历史令牌清理**：从历史项目中删除了敏感令牌
- **Python 3.9兼容性**：修复了兼容性问题

**错误修复和稳定性**
- **MaskComposite修复**：解决了目标蒙版的错误
- **Fresca输入/输出**：修正了Fresca模型工作流程的处理
- **引用错误修复**：解决了Gemini节点实现中的引用问题
- **行结束标准化**：自动检测和删除Windows行结束符

**开发体验**
- **警告系统**：添加了torch导入错误警告
- **模板更新**：更新了多个模板版本
- **文档**：增强了fast_fp16_accumulation的文档

</Update>
<Update label="v0.3.44" description="2025年7月8日">

**采样和模型控制增强**

此版本改进了采样算法和模型控制系统：

**新采样功能**
- **TCFG节点**：增强的分类器无关引导控制
- **ER-SDE采样器**：从VE迁移到VP算法
- **跳层引导（SLG）**：用于推理期间精确层级控制

**开发工具**
- **自定义节点管理**：新的`--whitelist-custom-nodes`参数
- **性能优化**：双CFG节点在CFG为1.0时自动优化
- **GitHub Actions集成**：自动化发布webhook通知

**图像处理**
- **新变换节点**：添加了ImageRotate和ImageFlip节点
- **ImageColorToMask修复**：修正了掩码值返回
- **3D模型支持**：上传3D模型到自定义子文件夹

**引导和条件**
- **PerpNeg引导器**：更新了前后CFG处理
- **潜在条件修复**：解决了多步骤工作流中的条件问题
- **去噪步骤**：为多个采样器添加去噪步骤支持

**平台稳定性**
- **PyTorch兼容性**：修复了PyTorch nightly构建的问题
- **FP8回退**：当FP8操作遇到异常时自动回退
- **音频处理**：移除了已弃用的torchaudio.save函数依赖

**模型集成**
- **Moonvalley节点**：为Moonvalley模型工作流添加原生支持
- **调度器重新排序**：简单调度器现在默认优先
- **模板更新**：更新了多个模板版本

**安全性**
- **安全加载**：在不安全加载文件时添加警告
- **文件验证**：增强检查点加载安全措施

</Update>
<Update label="v0.3.43" description="2025年6月30日">

**模型支持与工作流可靠性**

本次更新改进了模型兼容性和工作流稳定性：

**扩展模型文档**：为Flux Kontext和Omnigen 2模型添加了支持文档
**VAE编码改进**：移除了VAE编码过程中不必要的随机噪声注入
**内存管理修复**：解决了影响Kontext模型使用的关键内存估算错误

</Update>

<Update label="v0.3.41" description="2025年6月17日">

**模型支持新增**
- **Cosmos Predict2支持**：实现文本到图像和图像到视频生成工作流
- **增强的Flux兼容性**：Chroma Text Encoder能与常规Flux模型协作
- **LoRA训练集成**：新增原生LoRA训练节点

**性能和硬件优化**
- **AMD GPU增强**：在AMD GPU上启用FP8操作和PyTorch注意力机制
- **Apple Silicon修复**：解决了Apple设备上的FP16注意力问题
- **Flux模型稳定性**：解决了特定Flux模型生成黑色图像的问题

**采样改进**
- **Rectified Flow采样器**：新增支持RF的SEEDS和多步DPM++ SDE采样器
- **ModelSamplingContinuousEDM**：新增cosmos_rflow选项
- **内存优化**：改进了Cosmos模型的内存估算

**开发和集成功能**
- **SQLite数据库支持**：增强自定义节点的数据管理功能
- **PyProject.toml集成**：从pyproject文件自动注册web文件夹
- **前端灵活性**：支持语义化版本后缀和预发布前端版本
- **分词器增强**：通过tokenizer_data配置min_length设置

**使用体验改进**
- **Kontext宽高比修复**：解决了小组件限制
- **SaveLora一致性**：统一了所有保存节点的文件名格式
- **Python版本警告**：为过时的Python安装添加警报
- **WebcamCapture修复**：修正了IS_CHANGED签名

</Update>


<Update label="v0.3.40" description="2025年6月5日">

**工作流工具和性能优化**

本次更新带来了新的工作流工具和性能优化：

**新工作流工具**
- **ImageStitch节点**：在工作流中拼接多个图像
- **GetImageSize节点**：提取图像尺寸并支持批处理
- **Regex Replace节点**：高级文本处理功能

**模型兼容性**
- **张量处理改进**：简化的列表处理使多模型工作流更可靠
- **BFL API优化**：完善了对Kontext模型的支持
- **性能提升**：在色度处理中使用融合乘加运算

**开发体验**
- **自定义节点支持**：添加pyproject.toml支持
- **帮助菜单集成**：在节点库侧边栏中新增帮助系统
- **API文档**：增强API节点文档

**前端和UI**
- **前端更新至v1.21.7**：多项稳定性修复和性能改进
- **自定义API基础支持**：改进了自定义部署配置的子路径处理
- **安全加固**：修复XSS漏洞

**错误修复和稳定性**
- **Pillow兼容性**：更新了已弃用的API调用
- **ROCm支持**：改进了AMD GPU用户的版本检测
- **模板更新**：增强了自定义节点开发的项目模板

</Update>
