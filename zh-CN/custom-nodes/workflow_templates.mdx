---
title: "工作流模板"
---

如果你的自定义节点包含示例工作流文件，ComfyUI 可以在模板浏览器（`工作流`/`浏览模板`菜单）中向用户展示这些文件。工作流模板是帮助用户快速上手你的节点的好方法。

作为节点开发者，你只需要创建一个 `example_workflows` 文件夹并在其中放置 `json` 文件即可。你还可以选择性地放置同名的 `jpg` 文件作为模板缩略图。

在底层，ComfyUI 会静态提供这些文件，并通过一个端点（`/api/workflow_templates`）返回工作流模板集合。

<Note>
目前以下文件夹名称也可以被接受，但我们仍旧建议使用`example_workflows` 
- workflow
- workflows
- example
- examples
</Note>

## 示例

在 `ComfyUI-MyCustomNodeModule/example_workflows/` 目录下：
 - `My_example_workflow_1.json`
 - `My_example_workflow_1.jpg`
 - `My_example_workflow_2.json`

在这个例子中，ComfyUI 的模板浏览器会显示一个名为 `ComfyUI-MyCustomNodeModule` 的类别，其中包含两个项目，其中一个带有缩略图。

## 最佳实践

### 工作流命名

使用描述性的文件名，帮助用户理解工作流的用途：

**好的命名示例：**
- `basic_image_enhancement.json` - 基础图像增强
- `advanced_portrait_processing.json` - 高级人像处理
- `batch_upscaling_workflow.json` - 批量放大工作流

**避免的命名：**
- `workflow1.json`
- `test.json`
- `untitled.json`

### 缩略图制作

创建有意义的缩略图图像：

1. **尺寸建议**: 512x512 像素或 1024x1024 像素
2. **格式**: JPG 格式（文件大小较小）
3. **内容**: 显示工作流的典型输出结果
4. **质量**: 使用高质量的示例图像

```bash
# 使用 ImageMagick 调整缩略图大小
convert input_image.png -resize 512x512 -quality 85 thumbnail.jpg
```

### 工作流文档

在工作流 JSON 中添加描述信息：

```json
{
  "last_node_id": 10,
  "last_link_id": 15,
  "nodes": [...],
  "links": [...],
  "groups": [],
  "config": {},
  "extra": {
    "ds": {
      "scale": 1,
      "offset": [0, 0]
    },
    "workflow_info": {
      "title": "基础图像增强工作流",
      "description": "使用自定义节点进行图像锐化和降噪处理",
      "author": "Your Name",
      "version": "1.0",
      "tags": ["image", "enhancement", "basic"],
      "requirements": ["ComfyUI-MyCustomNode >= 1.0.0"]
    }
  },
  "version": 0.4
}
```

### 多语言支持

为不同语言创建工作流模板：

```
example_workflows/
├── en/
│   ├── basic_workflow.json
│   └── basic_workflow.jpg
├── zh/
│   ├── 基础工作流.json
│   └── 基础工作流.jpg
└── ja/
    ├── 基本ワークフロー.json
    └── 基本ワークフロー.jpg
```

### 工作流验证

确保工作流模板的质量：

1. **测试完整性**: 确保工作流可以成功执行
2. **依赖检查**: 验证所有必需的模型和节点都可用
3. **参数合理性**: 使用合理的默认参数值
4. **输出质量**: 确保示例输出具有代表性和高质量

### 自动化工作流生成

可以创建脚本来自动生成工作流模板：

```python
import json
from pathlib import Path

def create_workflow_template(name, nodes_config, output_path):
    """创建工作流模板"""
    workflow = {
        "last_node_id": len(nodes_config),
        "last_link_id": 0,
        "nodes": [],
        "links": [],
        "groups": [],
        "config": {},
        "extra": {
            "ds": {"scale": 1, "offset": [0, 0]},
            "workflow_info": {
                "title": name,
                "description": f"{name}的示例工作流",
                "version": "1.0"
            }
        },
        "version": 0.4
    }
    
    # 添加节点配置
    for i, node_config in enumerate(nodes_config):
        node = {
            "id": i + 1,
            "type": node_config["type"],
            "pos": node_config.get("pos", [100 + i * 200, 100]),
            "size": node_config.get("size", [200, 100]),
            "flags": {},
            "order": i,
            "mode": 0,
            "inputs": node_config.get("inputs", []),
            "outputs": node_config.get("outputs", []),
            "properties": {},
            "widgets_values": node_config.get("widgets_values", [])
        }
        workflow["nodes"].append(node)
    
    # 保存工作流
    output_file = Path(output_path) / f"{name}.json"
    with open(output_file, 'w', encoding='utf-8') as f:
        json.dump(workflow, f, indent=2, ensure_ascii=False)
    
    print(f"工作流模板已保存到: {output_file}")

# 使用示例
nodes_config = [
    {
        "type": "LoadImage",
        "pos": [100, 100],
        "widgets_values": ["example.png", "image"]
    },
    {
        "type": "MyCustomNode", 
        "pos": [350, 100],
        "widgets_values": [1.0, "default"]
    }
]

create_workflow_template("基础图像处理", nodes_config, "example_workflows")
```

## 高级功能

### 条件工作流模板

创建根据用户输入动态调整的工作流：

```json
{
  "extra": {
    "workflow_info": {
      "title": "条件图像处理",
      "description": "根据输入类型自动调整处理流程",
      "conditions": {
        "image_type": {
          "portrait": "portrait_processing.json",
          "landscape": "landscape_processing.json",
          "square": "square_processing.json"
        }
      }
    }
  }
}
```

### 批量工作流模板

为批量处理创建专门的工作流模板：

```json
{
  "extra": {
    "workflow_info": {
      "title": "批量图像处理",
      "description": "适用于大量图像的批处理工作流",
      "batch_settings": {
        "max_batch_size": 10,
        "memory_optimization": true,
        "parallel_processing": false
      }
    }
  }
}
```

## 社区贡献

### 分享工作流模板

鼓励用户分享他们的工作流模板：

1. **创建模板库**: 建立社区模板仓库
2. **标准化格式**: 使用统一的命名和描述格式
3. **质量控制**: 建立模板审核机制
4. **版本管理**: 跟踪模板的版本变化

### 模板评级系统

实现用户评级和反馈系统：

```json
{
  "extra": {
    "workflow_info": {
      "rating": 4.5,
      "downloads": 1250,
      "reviews": [
        {
          "user": "user123",
          "rating": 5,
          "comment": "非常实用的工作流！"
        }
      ]
    }
  }
}
```
