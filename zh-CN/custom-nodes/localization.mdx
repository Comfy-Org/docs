---
title: "如何为 ComfyUI 自定义节点添加本地化支持"
sidebarTitle: "本地化"
---

ComfyUI本地化系统要求自定义节点在其扩展文件夹中按照特定的目录层次结构组织翻译文件。

你可以参考 [ComfyUI-IC-Light-Native](https://github.com/huchenlei/ComfyUI-IC-Light-Native) 插件来了解如何进行本地化的实现。

## 目录结构

自定义节点应该将翻译文件放在其扩展文件夹内的 `locales/` 目录中，并为每个支持的语言代码创建子目录。

预期的文件夹结构如下：

```
custom_nodes/  
  your_extension/  
    locales/  
      en/  
        main.json  
        nodeDefs.json  
        commands.json  
        settings.json  
      zh/  
        main.json  
        nodeDefs.json  
        commands.json  
        settings.json  
      [其他语言代码...]  
```

## 支持的语言

系统支持以下语言代码：en（英语）、zh（中文）、ru（俄语）、ja（日语）、ko（韩语）、fr（法语）和es（西班牙语）。README.md:5-13

## 翻译文件内容
系统为每种语言加载四个主要的JSON文件：[custom_node_manager](https://github.com/comfyanonymous/ComfyUI/blob/master/app/custom_node_manager.py)

### main.json

包含通用UI字符串、对话框消息、常用标签和其他通用界面文本。这包括一般消息（g）、管理器相关文本（manager）、颜色名称（color）、上下文菜单（contextMenu）和其他UI元素等类别。main.json:1-127

### nodeDefs.json

包含节点特定的翻译，包括显示名称和输入/输出参数名称。每个节点都以其类名作为键定义，包含display_name和带参数名称的inputs。nodeDefs.json:1-100

### commands.json

包含菜单项、键盘快捷键和界面中其他可操作项的命令标签和描述。每个命令都由带有label属性的唯一键标识。

### settings.json

包含配置项的设置名称、工具提示和选项标签。每个设置包括一个name字段，以及可选的工具提示和下拉选择的选项。

## 加载过程

CustomNodeManager在初始化期间自动发现并加载翻译文件。它合并来自多个自定义节点的翻译，后加载的扩展可能会覆盖先前加载的扩展中的冲突键，查看相关代码[custom_node_manager](https://github.com/comfyanonymous/ComfyUI/blob/master/app/custom_node_manager.py)

前端将这些文件组合成一个统一的翻译对象，其结构如下：

```json
{  
  "language_code": {  
    "main": "main.json的内容",  
    "nodeDefs": "nodeDefs.json的内容",  
    "commands": "commands.json的内容",  
    "settings": "settings.json的内容"  
  }  
}
```

## 与自定义节点Web目录的集成

如果您的自定义节点使用 `WEB_DIRECTORY` 属性来自定义UI组件，请将 `locales/` 文件夹放在该web目录中。

## 注意事项

- 翻译文件是可选的 - 系统会优雅地处理缺失的文件
- 无效的JSON文件会被忽略并记录错误
- 系统使用递归合并来组合来自多个来源的翻译
- 所有翻译键都应使用一致的命名约定，以避免与其他扩展发生冲突


