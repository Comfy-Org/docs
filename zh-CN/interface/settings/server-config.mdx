---
title: "服务器配置"
description: "ComfyUI 服务器配置选项的详细说明"
icon: "fa-solid fa-server"
sidebarTitle: "服务器配置"
---

<Note>
目前 `Server-Config` 设置菜单仅在针对 Desktop 版本中存在，其它版本中并无此设置菜单项目
</Note>


## 网络设置 (Network)

### 基础连接配置
- **主机地址 (listen)**:
  设置服务器绑定的IP地址。默认 `127.0.0.1` 表示只允许本地访问，如果需要局域网访问可设置为 `0.0.0.0`

- **端口 (port)**:
  服务器监听的端口号。桌面版默认8000端口，Web版通常使用8188端口

- **最大上传大小 (max-upload-size)**:
  限制单个文件上传的最大尺寸，单位为MB，默认100MB。影响图片、模型等文件的上传限制

### HTTPS安全配置
- **TLS密钥文件 (tls-keyfile)**:
  HTTPS加密所需的私钥文件路径，用于建立安全连接

- **TLS证书文件 (tls-certfile)**:
  HTTPS加密所需的证书文件路径，与私钥配合使用

### 跨域访问控制
- **CORS头 (enable-cors-header)**:
  控制跨域资源共享。设置为 "*" 允许所有域名访问，或指定特定域名以增强安全性

## CUDA硬件配置

- **CUDA设备索引 (cuda-device)**:
  指定使用哪块NVIDIA显卡。0表示第一块显卡，1表示第二块，以此类推。对多GPU系统很重要

- **CUDA内存分配 (cuda-malloc)**:
  控制是否使用CUDA的内存分配器。可以改善某些情况下的内存管理效率

## 推理精度设置 (Inference)

### 数值精度控制
- **全局浮点精度 (global-precision)**:
  设置模型计算的数值精度。FP16节省显存但可能影响质量，FP32更精确但占用更多显存

- **UNET精度 (unet-precision)**: 
  专门控制扩散模型核心组件UNET的计算精度，影响图像生成质量和显存使用

- **VAE精度 (vae-precision)**: 
  控制变分自编码器的计算精度，影响图像编码/解码的质量和速度

- **文本编码器精度 (text-encoder-precision)**: 
  控制文本提示词编码器的精度，影响文本理解准确性

### 设备分配
- **CPU运行VAE (cpu-vae)**: 
  强制VAE在CPU上运行，可以节省显存但会降低处理速度

- **DirectML设备索引 (directml)**: 
  在Windows上使用DirectML加速时指定设备，主要用于AMD显卡

### 算法优化
- **确定性算法 (deterministic)**:
  启用后使用确定性算法，相同输入会产生相同输出，但计算速度较慢

- **快速模式 (fast)**: 
  启用实验性优化，可能提升速度但可能影响生成质量

## 内存管理 (Memory)

### VRAM显存管理
- **VRAM管理模式 (vram-management)**: 
  控制显存的使用策略，如自动管理、低显存模式等

- **保留VRAM (reserve-vram)**:
  为操作系统和其他程序预留的显存量，防止系统卡死

- **禁用智能内存管理 (disable-smart-memory)**:
  关闭自动内存优化，强制将模型移到系统内存以释放显存

### 内存布局优化
- **强制channels-last格式 (force-channels-last)**: 
  改变内存中数据的排列方式，可能提升某些硬件上的性能

## 注意力机制优化 (Attention)

- **交叉注意力方法 (cross-attention-method)**: 
  选择注意力计算的具体算法，影响生成质量和速度

- **禁用xFormers优化 (disable-xformers)**: 
  关闭Facebook的xFormers库优化，可能解决兼容性问题

- **强制upcast-attention (force-upcast-attention)**: 
  强制使用高精度计算注意力，提升质量但增加显存使用

- **禁用upcast-attention (dont-upcast-attention)**: 
  禁用高精度注意力计算，节省显存

- **禁用IPEX优化 (disable-ipex-optimize)**: 
  关闭Intel CPU优化，主要影响Intel处理器的性能

## 缓存系统 (Cache)

- **经典缓存系统 (cache-classic)**: 
  使用传统的缓存策略，更保守但稳定

- **LRU缓存 (cache-lru)**:
  使用最近最少使用算法的缓存，可以缓存更多结果但占用更多内存

## 预览功能 (Preview)

- **预览方法 (preview-method)**: 
  选择生成过程中预览图像的算法，影响预览质量和速度

- **预览图像大小 (preview-size)**: 
  设置预览图像的分辨率，影响预览清晰度和性能

## 文件路径 (Directories)

- **输入目录 (input-directory)**: 
  设置输入文件（如图片、模型）的默认存放路径

- **输出目录 (output-directory)**: 
  设置生成结果的保存路径

## 系统控制 (General)

### 日志调试
- **日志详细级别 (log-level)**:
  控制日志输出的详细程度，从简单到详细：ERROR、WARNING、INFO、DEBUG

- **不打印服务器输出 (dont-print-server)**:
  禁止在控制台显示服务器运行信息，保持界面整洁

### 功能开关
- **禁用元数据保存 (disable-metadata)**:
  不在生成的图片中保存工作流信息，减少文件大小但失去可重现性

- **禁用所有自定义节点 (disable-all-custom-nodes)**:
  禁止加载第三方扩展节点，提升启动速度和稳定性

- **默认哈希函数 (default-hashing-function)**: 
  设置模型文件校验的哈希算法，用于验证文件完整性

**Notes**

这些配置项在服务器配置文件中定义，并通过设置面板按类别分组显示。修改后需要重启应用才能生效。
