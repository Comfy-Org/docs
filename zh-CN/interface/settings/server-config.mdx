---
title: "服务器配置"
description: "ComfyUI 服务器配置选项的详细说明"
icon: "server"
sidebarTitle: "服务器配置"
---

<Note>
目前 `Server-Config` 设置菜单仅在针对 Desktop 版本中存在，其它版本中并无此设置菜单项目
</Note>

## 网络

### 主机：要监听的IP地址
- **主机地址 (listen)**:
- **功能**：设置服务器绑定的IP地址。默认 `127.0.0.1` 表示只允许本地访问，如果需要局域网访问可设置为 `0.0.0.0`

<Tip>
  虽然我们为 Desktop 版本提供了局域网监听设置的能力，但是作为桌面版，它本身并不适合作为服务器使用，我们建议如果你需要将 ComfyUI 示例作为局域网内的公共服务使用，请参考手动部署教程部署对应的 ComfyUI 服务。
</Tip>

### 端口端口：要监听的端口
**功能**：服务器监听的端口号。桌面版默认8000端口，Web版通常使用8188端口


### TTLS 密钥文件：HTTPS 的 TLS 密钥文件路径
**功能**：HTTPS加密所需的私钥文件路径，用于建立安全连接


### TLS 证书文件：HTTPS 的 TLS 证书文件路径
**功能**：HTTPS加密所需的证书文件路径，与私钥配合使用

### 最大上传大小
- **最大上传大小 (max-upload-size)**:
- **功能**：限制单个文件上传的最大尺寸，单位为MB，默认100MB。影响图片、模型等文件的上传限制
  限制单个文件上传的最大尺寸，单位为MB，默认100MB。影响图片、模型等文件的上传限制


## CUDA

### 要使用的 CUDA 设备索引
**功能**：指定使用哪块NVIDIA显卡。0表示第一块显卡，1表示第二块，以此类推。对多GPU系统很重要

### 使用 CUDA malloc 进行内存分配
**功能**：控制是否使用CUDA的内存分配器。可以改善某些情况下的内存管理效率

## 推理

### 全局浮点精度
**功能**：设置模型计算的数值精度。FP16节省显存但可能影响质量，FP32更精确但占用更多显存

### UNET 精度
**选项**：
- `auto`：自动选择最合适的精度
- `fp64`：64位浮点精度，精度最高但显存占用最大
- `fp32`：32位浮点精度，标准精度
- `fp16`：16位浮点精度，可节省显存
- `bf16`：16位brain浮点精度，介于fp16和fp32之间
- `fp8_e4m3fn`：8位浮点精度(e4m3)，显存占用最小
- `fp8_e5m2`：8位浮点精度(e5m2)，显存占用最小

**功能**：专门控制扩散模型核心组件UNET的计算精度。更高的精度可以提供更好的图像生成质量，但会占用更多显存。较低的精度可以显著节省显存，但可能会影响生成结果的质量。

### VAE 精度

**选项与建议**：
- `auto`：自动选择最合适的精度，推荐8-12GB显存的用户使用
- `fp16`：16位浮点精度，推荐6GB及以下显存的用户使用，可节省显存但可能影响质量
- `fp32`：32位浮点精度，推荐16GB及以上显存且追求最佳质量的用户使用
- `bf16`：16位brain浮点精度，推荐支持此格式的新型显卡使用，可获得更好的性能平衡

**功能**：控制变分自编码器(VAE)的计算精度，影响图像编码/解码的质量和速度。更高的精度可以提供更好的图像重建质量，但会占用更多显存。较低的精度可以节省显存，但可能会影响图像的细节还原。

### 文本编码器精度
**选项**：
- `auto`：自动选择最合适的精度
- `fp8_e4m3fn`：8位浮点精度(e4m3)，显存占用最小
- `fp8_e5m2`：8位浮点精度(e5m2)，显存占用最小
- `fp16`：16位浮点精度，可节省显存
- `fp32`：32位浮点精度，标准精度

**功能**：控制文本提示词编码器的计算精度，影响文本理解的准确性和显存占用。更高的精度可以提供更准确的文本理解，但会占用更多显存。较低的精度可以节省显存，但可能会影响提示词的解析效果。

## 内存

### 强制使用 channels-last 内存格式
**功能**：改变内存中数据的排列方式，可能提升某些硬件上的性能

### DirectML 设备索引
**功能**：在Windows上使用DirectML加速时指定设备，主要用于AMD显卡

### 禁用IPEX优化
**功能**：关闭Intel CPU优化，主要影响Intel处理器的性能

### VRAM 管理模式
**选项**：
- `auto`：自动管理显存，根据模型大小和需求自动分配显存
- `lowvram`：低显存模式，只使用最低限度的显存，可能会影响生成质量
- `normalvram`：标准显存模式，平衡显存使用和性能
- `highvram`：高显存模式，使用较多显存以获得更好性能
- `novram`：不使用显存，完全使用系统内存运行
- `cpu`：仅使用CPU运行，不使用显卡

**功能**：控制显存的使用策略，如自动管理、低显存模式等

### 保留VRAM
**功能**：为操作系统和其他程序预留的显存量，防止系统卡死


### 禁用智能内存管理
**功能**：关闭自动内存优化，强制将模型移到系统内存以释放显存

### CPU 运行 VAE
**功能**：强制VAE在CPU上运行，可以节省显存但会降低处理速度

## 预览

### 用于潜空间预览的方法
**选项**:
- `none`: 不显示预览图像,生成过程中只显示进度条
- `auto`: 自动选择最合适的预览方法,根据系统性能和显存情况动态调整
- `latent2rgb`: 直接将潜空间数据转换为RGB图像进行预览,速度较快但质量一般
- `taesd`: 使用轻量级的TAESD模型进行预览,在速度和质量之间取得平衡

**功能**: 控制生成过程中如何预览中间结果。不同的预览方法会影响预览的质量和性能消耗。选择合适的预览方法可以在预览效果和系统资源占用之间找到平衡点。

### 预览图像大小
**功能**：设置预览图像的分辨率，影响预览清晰度和性能，尺寸越大，预览质量越高，但也会占用更多显存


### 算法优化
- **确定性算法 (deterministic)**:
  启用后使用确定性算法，相同输入会产生相同输出，但计算速度较慢

- **快速模式 (fast)**: 
  启用实验性优化，可能提升速度但可能影响生成质量

## 缓存

### 经典缓存系统
**功能**：使用传统的缓存策略，更保守但稳定

### 使用 LRU 缓存，最多缓存 N 个节点结果

**功能**：使用最近最少使用(Least Recently Used)算法的缓存系统，可以缓存指定数量的节点计算结果

**说明**:
- 通过设置一个具体的数字来控制最大缓存数量，如 10、50、100 等
- 缓存可以避免重复计算相同的节点操作，提高工作流执行速度
- 当缓存达到上限时，会自动清除最久未使用的结果
- 缓存的结果会占用系统内存(RAM/VRAM)，数值越大占用越多

**使用建议**:
- 默认值为 null，表示不启用 LRU 缓存
- 根据系统内存容量和使用需求设置合适的缓存数量
- 对于经常重复使用相同节点配置的工作流，建议启用此功能
- 如果系统内存充足，可以设置较大的数值以获得更好的性能提升

## 注意力

### 交叉注意力方法
**选项**:
- `auto`: 自动选择最合适的注意力计算方法
- `split`: 分块计算注意力,可以节省显存但速度较慢
- `quad`: 使用四分注意力算法,在速度和显存使用上取得平衡
- `pytorch`: 使用PyTorch原生注意力计算,速度较快但显存占用大

**功能**: 控制模型计算注意力时使用的具体算法。不同的算法会在生成质量、速度和显存占用之间做出不同的权衡。通常建议使用auto自动选择。


- **强制upcast-attention (force-upcast-attention)**: 
  强制使用高精度计算注意力，提升质量但增加显存使用

- **禁用upcast-attention (dont-upcast-attention)**: 
  禁用高精度注意力计算，节省显存

## 常规

### 禁用xFormers优化
**功能**：关闭 xFormers 库的优化功能。xFormers 是一个专门优化 Transformer 模型注意力机制的库，通常可以提高计算效率、减少内存使用并加快推理速度。禁用此优化后会：

- 回退到标准的注意力计算方法
- 可能增加内存使用和计算时间
- 在某些情况下提供更稳定的运行环境

**使用场景**：
- 遇到与 xFormers 相关的兼容性问题时
- 需要更精确的计算结果时（某些优化可能影响数值精度）
- 在调试或排查问题时需要使用标准实现

### 模型文件的默认哈希函数
**选项**:
- `sha256`: 使用 SHA-256 算法进行哈希校验,安全性高但计算较慢
- `sha1`: 使用 SHA-1 算法,速度较快但安全性稍低
- `sha512`: 使用 SHA-512 算法,提供最高安全性但计算最慢
- `md5`: 使用 MD5 算法,速度最快但安全性较低

**功能**：设置模型文件校验的哈希算法，用于验证文件完整性。不同的哈希算法在计算速度和安全性之间有不同的权衡。通常建议使用 sha256 作为默认选项，它能在安全性和性能之间取得较好的平衡。

### 使 pytorch 在可以时使用较慢的确定性算法

**功能**: 强制 PyTorch 在可能的情况下使用确定性算法，以提高结果的可重现性。

**说明**:
- 启用后 PyTorch 会优先使用确定性算法而不是更快的非确定性算法
- 相同的输入将产生相同的输出，有助于调试和结果验证
- 确定性算法通常比非确定性算法运行更慢
- 即使启用此设置，也不能完全保证在所有情况下都能产生完全相同的图像结果

**使用场景**:
- 科学研究需要严格的结果可重现性
- 调试过程中需要稳定的输出结果
- 生产环境中需要保证结果一致性

### 不打印服务器输出
**功能**：禁止在控制台显示服务器运行信息，保持界面整洁。

**说明**:
- 启用后将不显示 ComfyUI 服务器的日志和运行信息
- 可以减少控制台的信息干扰，使界面更加清爽
- 在大量日志输出时可能略微提升系统性能
- 默认为关闭状态(false)，即默认显示服务器输出

**使用场景**:
- 生产环境中不需要查看调试信息时
- 希望保持控制台界面整洁时
- 系统运行稳定无需监控日志时

**注意**：在开发和调试过程中建议保持此选项关闭，以便及时查看服务器的运行状态和错误信息。

### 禁用在文件中保存提示元数据
**功能**：不在生成的图片中保存工作流信息，减少文件大小，但同时也意味着对应工作流信息的缺失，你无法再使用工作流输出的文件来重现对应的生成结果

### 禁用所有自定义节点
**功能**：禁止加载所有第三方扩展节点，通常用于在排查问题时使用，用于来定位对应的错误是否由于第三方扩展节点导致

### 日志详细级别
**功能**：控制日志输出的详细程度，用于调试和监控系统运行状态。

**选项**:
- `CRITICAL`: 仅输出严重错误信息，这些错误可能导致程序无法继续运行
- `ERROR`: 输出错误信息，表示某些功能无法正常工作
- `WARNING`: 输出警告信息，表示可能存在的问题但不影响主要功能
- `INFO`: 输出一般信息，包括系统运行状态和重要操作记录
- `DEBUG`: 输出最详细的调试信息，包括系统内部运行的细节

**说明**:
- 日志级别从上到下详细程度递增
- 每个级别都会包含比它更高级别的所有日志信息
- 建议在正常使用时设置为 INFO 级别
- 在排查问题时可以设置为 DEBUG 级别以获取更多信息
- 在生产环境中可以设置为 WARNING 或 ERROR 级别以减少日志量

## 目录

### 输入目录
**功能**：设置输入文件（如图片、模型）的默认存放路径

### 输出目录
**功能**：设置生成结果的保存路径