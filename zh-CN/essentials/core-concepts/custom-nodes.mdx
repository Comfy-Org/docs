---
title: "自定义节点"
description: "了解 ComfyUI 中自定义节点的安装、依赖启用、更新、禁用、卸载"
icon: "file"
---

## 关于自定义节点

ComfyUI 原生节点节点。这些被称为 **Comfy Core** 节点，这些节点都是由 ComfyUI 官方维护的原生节点。此外还有许多来自 ComfyUI 社区的众多作者带来的各种各样的 [**自定义节点**](https://registry.comfy.org)，这些自定义节点为 ComfyUI 带来了诸多的扩展功能，大大扩展了 ComfyUI 的功能和能力边界。
在本指南中，我们将介绍如何自定义节点相关的一些操作，包括安装、更新、禁用、卸载、依赖安装等。

## 自定义节点管理

在这个部分我们将讲解如何安装、更新、禁用、卸载自定义节点，以及如何管理自定义节点的依赖。

### 安装自定义节点

目前 ComfyUI 支持通过多种方式安装自定义节点，包括：

- 通过 Git 安装
- 手动安装
- [通过 ComfyUI Manager 安装（推荐）](#ComfyUI Manager)

我们推荐通过 ComfyUI Manager 来安装自定义节点，因为这使得自定义节点的管理变得非常简单，你只需要在 ComfyUI Manager 中搜索你想要安装的节点，然后点击安装即可，但由于目前所有的自定义节点都是存储在 GitHub 上，所以在本篇针对于某些无法正常访问 GitHub 的的地区，我们在本篇撰写了详尽的不同的自定义节点的安装方式。

另外由于我们推荐使用 **ComfyUI Manager** 进行对应的插件管理，这是一个在 ComfyUI 自定义节点生态中具有非常重要意义的一个工具，它使得自定义节点管理（如搜索、安装、更新、禁用和卸载）变得简单，我们推荐使用这一工具来进行插件的管理，你可以在[这里](https://github.com/Comfy-Org/ComfyUI-Manager)找到它的源码。
所以在本篇文档中，我们将会使用安装 ComfyUI Manager 作为自定义节点安装示例，并在本篇的相关介绍部分补充如何使用它来进行节点的管理。

<Tabs>
<Tab title="通过 Git 安装">

<Steps>

<Step title="确保 Git 已经安装">
首先你需要确保在你的系统中已经安装了 Git，你可以在对应的系统终端(terminal)中输入下面的命令来检查是否已经安装了 Git。

```bash
git --version
```

如果已经安装了 Git，你将会看到类似如下的输出：


![Windows 终端](/images/concepts/custom_nodes/win_terminal.jpg)

如果还没有安装，请访问 [git-scm.com](https://git-scm.com/) 下载对应的安装包进行安装, linux 用户请参考 [git-scm.com/downloads/linux](https://git-scm.com/downloads/linux) 这个部分来完成对应的安装。
</Step>

<Step title="克隆自定义节点代码到对应目录">

在完成 Git 的安装后，我们需要对应的自定义节点的仓库地址，在这里我们使用 ComfyUI-Manager 的仓库地址作为示例:

```bash
https://github.com/Comfy-Org/ComfyUI-Manager
```

<Tip>对于无法顺利访问 GitHub 的地区，可以尝试使用其它的代码托管服务网站来 fork 对应的仓库，然后使用对应的仓库地址来完成对应的节点安装，比如 gitee 等。</Tip>

我们首先需要进入到 ComfyUI 的自定义节点的相关目录，以 ComfyUI 便携版为例，如果对应文件夹位置为`D:\ComfyUI_windows_portable`，那么你应该可以找到对应自定义节点的文件夹为`D:\ComfyUI_windows_portable\ComfyUI\custom_nodes`，首先我们需要使用 `cd` 命令进入到对应的目录

```bash
cd D:\ComfyUI_windows_portable\ComfyUI\custom_nodes
```

然后我们使用 `git clone` 命令来完成对应的节点安装。

```bash
git clone https://github.com/Comfy-Org/ComfyUI-Manager
```

如果一切顺利，你将会看到类似如下的输出：

![通过 Git 安装自定义节点](/images/concepts/custom_nodes/install_custom_nodes_by_git.jpg)

这意味着你已经成功克隆了对应的自定义节点的代码，接下来我们需要进行对应依赖的安装。
</Step>
<Step title="安装依赖">
请参考[安装节点依赖](#安装节点依赖)章节中的说明进行对应的依赖安装。
</Step>
</Steps>

</Tab>

<Tab title="手动安装">
手动安装虽然不是推荐的安装方式，但在你无法使用 git 安装的情况下，这不失为一个备用的方案。

<Steps>
<Step title="下载自定义节点代码 zip 包">
使用手动安装我们需要首先下载对应的节点代码，然后解压到对应的目录。

![下载节点代码](/images/concepts/custom_nodes/download_zip.jpg)

访问对应自定义节点的仓库界面
1. 点击 `Code` 按钮
2. 然后点击 `Download ZIP` 按钮，下载对应的 zip 包。
3. 解压对应的 zip 包
</Step>
<Step title="复制对应的节点代码到 ComfyUI 自定义节点目录">
将上面步骤解压后的代码复制到 ComfyUI 自定义节点目录，以 ComfyUI 便携版为例，如果对应文件夹位置为`D:\ComfyUI_windows_portable`，那么你应该可以找到对应自定义节点的文件夹为`D:\ComfyUI_windows_portable\ComfyUI\custom_nodes`，将上面步骤解压后的代码复制到对应的目录。
</Step>
<Step title="安装依赖">
请参考[安装节点依赖](#安装节点依赖)章节中的说明进行对应的依赖安装。
</Step>
</Steps>
</Tab>

</Tabs>

在完成对应的代码的克隆后，我们需要安装对应的依赖，ComfyUI 中对应的依赖需要安装在其对应的 Python 环境中，所以你需要首先进入到对应的 Python 环境，然后使用 `pip install -r requirements.txt` 命令来完成对应的依赖安装, 让我们在下一节中继续详细介绍
#### 安装节点依赖

### 自定义节点版本控制

自定义节点的版本控制，实际上是基于 Git 的版本控制来进行的，你可以通过 Git 来进行对应的节点版本管理，
### 卸载自定义节点

### 临时禁用自定义节点

### 自定义节点依赖冲突

## ComfyUI Manager

![ComfyUI 管理器界面](/images/concepts/core-concepts_nodes_manager.png)


目前在 [Desktop 版本](/zh-CN/installation/desktop/windows) 中已默认包含该工具,而在[便携（Portable）版](/zh-CN/installation/comfyui_portable_windows)中，你需要参考本文档中[安装管理器](#安装自定义节点)章节中的说明进行安装。

<Note>
由于随着 ComfyUI 的发展，ComfyUI Manager 在 ComfyUI 中的角色也愈加重要，目前 ComfyUI-Manager 已经正式加入 Comfy Org 组织，正式成为 ComfyUI 核心依赖的一部分，并且由原作者[Dr.Lt.Data](https://github.com/ltdrdata)继续维护，你可以查看[这篇博客](https://blog.comfy.org/p/comfyui-manager-joins-comfy-org)了解更多信息。
并且在未来迭代中，我们会大大优化 ComfyUI Manager 的使用，所以本文的中使用说明文档的界面，可能会与最新版本的 ComfyUI Manager 界面有所不同。
</Note>

### 安装管理器

如果您正在运行 ComfyUI 服务器应用程序，则需要安装管理器。如果 ComfyUI 正在运行，请在继续之前将其关闭。

第一步是安装 Git，这是一个用于软件版本控制的命令行应用程序。Git 将从 [github.com](https://github.com) 下载 ComfyUI 管理器。从 [git-scm.com](https://git-scm.com/) 下载并安装 Git。

安装 Git 后，导航到 ComfyUI 服务器程序目录，进入标记为 **custom_nodes** 的文件夹。打开命令窗口或终端。确保命令行显示当前目录路径为 **custom_nodes**。输入以下命令。这将下载管理器。从技术上讲，这被称为 _克隆 Git 仓库_。

### 检测缺失的节点

在安装管理器后，你可以在管理器中检测到缺失的节点。

![ComfyUI 管理器界面](/images/concepts/core-concepts_nodes_manager.png)
## 开发一个自定义节点

如果你具有一定的开发能力，请从下面的文档开始以了解如何开始开发一个自定义节点。

<Card title="开始开发自定义节点" icon="link" href="/custom-nodes/overview">
  了解如何开始开发一个自定义节点
</Card>


